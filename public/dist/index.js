(()=>{"use strict";function e(e,t,n,r,l,a,o){try{var c=e[a](o),i=c.value}catch(e){return void n(e)}c.done?t(i):Promise.resolve(i).then(r,l)}function t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,l,a=[],o=!0,c=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(e){c=!0,l=e}finally{try{o||null==n.return||n.return()}finally{if(c)throw l}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var r=wp.blockEditor,l=r.useBlockProps,a=r.PlainText,o=(r.InspectorControls,wp.element),c=o.useState,i=o.useEffect,u=o.useCallback,p=o.memo,s=wp.components,m=(s.Button,s.PanelBody,s.SelectControl);console.log(wp.components);var d=wpalbAjaxValues,v=d.api,f=d.action,w=d.nonce;var b=wp.blockEditor.useBlockProps;(0,wp.blocks.registerBlockType)("merihari/applink",{apiVersion:2,title:"アプリリンク",description:"",category:"merihari",icon:"instagram",supports:{html:!1},keywords:["リンク","埋め込み","アプリ","apple","app","embed","link"],attributes:{app:{type:"object",default:{}}},edit:function(n){var r=l(),o=n.attributes,s=n.setAttributes,d=o.app,b=t(c(""),2),h=b[0],k=b[1],y=t(c(""),2),g=y[0],E=y[1],P=t(c({}),2),A=P[0],S=P[1],U=t(c("software"),2),j=U[0],x=U[1],C=function(){var t,n=(t=regeneratorRuntime.mark((function e(){var t,n,r,l,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new URLSearchParams).append("country","JP"),t.append("lang","ja_JP"),t.append("entity",j),t.append("term",h),t.append("limit","10"),t.append("at","11l64V"),n="https://itunes.apple.com/search?"+t.toString(),(r=new URLSearchParams).append("action",f),r.append("nonce",w),r.append("url",n),e.prev=12,e.next=15,fetch(v,{method:"post",body:r});case 15:return l=e.sent,e.next=18,l.json();case 18:return a=e.sent,e.next=21,S(a);case 21:console.log(n),e.next=27;break;case 24:e.prev=24,e.t0=e.catch(12),console.error(e.t0);case 27:case"end":return e.stop()}}),e,null,[[12,24]])})),function(){var n=this,r=arguments;return new Promise((function(l,a){var o=t.apply(n,r);function c(t){e(o,l,a,c,i,"next",t)}function i(t){e(o,l,a,c,i,"throw",t)}c(void 0)}))});return function(){return n.apply(this,arguments)}}(),N=u((function(e){s({app:{title:e.trackName,url:e.trackViewUrl,artist:e.artistName,artworkUrl:e.artworkUrl100||e.artworkUrl512||e.artworkUrl60}}),console.log("clicked")})),B=p((function(){return Object.keys(d).length>0?wp.element.createElement("div",null,wp.element.createElement("div",null,d.title),wp.element.createElement("div",null,d.artist),wp.element.createElement("div",null,wp.element.createElement("img",{src:d.artworkUrl,alt:"","aria-hidden":"true"})),wp.element.createElement("div",null,wp.element.createElement("a",{href:d.url,target:"_blank",rel:"noopener noreferrer"},"リンク"))):wp.element.createElement("div",null,"appありません")})),O=p((function(){return Object.keys(A).length>0&&-1!==Object.keys(A).indexOf("results")?A.results.map((function(e,t){return wp.element.createElement("div",{key:t},wp.element.createElement("div",{style:{width:"1rem",height:"1rem"}},wp.element.createElement("img",{src:e.artworkUrl100})),wp.element.createElement("div",null,e.trackName),wp.element.createElement("button",{className:"button",onClick:function(){return N(e)}},"これにする"))})):wp.element.createElement("div",null,"resultありません")}));return i((function(){console.log("term",h),""!==h?(C(),console.log("fetchしました")):console.log("fetchしませんでした")}),[h]),wp.element.createElement("div",r,wp.element.createElement("div",{className:"wp-block-merihari-blogcard-url"},wp.element.createElement(m,{label:"選べ",value:j,onChange:function(e){return x(e)},options:[{value:"software",label:"iPhone App"},{value:"iPadSoftware",label:"iPad App"},{value:"macSoftware",label:"Mac App"},{value:"movie",label:"ムービー"},{value:"audiobook",label:"AudioBook"},{value:"podcast",label:"Podcast"},{value:"tvEpisode",label:"TV Episode"},{value:"ebook",label:"ブック"},{value:"musicArtist",label:"音楽アーティスト"},{value:"musicTrack",label:"音楽トラック"},{value:"album",label:"音楽アルバム"},{value:"musicVideo",label:"ミュージックビデオ"}]}),wp.element.createElement(a,{className:"wp-block-merihari-blogcard-input",tagName:"input",placeholder:"URLを入力してEnter",value:g,onChange:function(e){return E(e)},onKeyPress:function(e){if("Enter"===e.key){if(e.preventDefault(),""===g)return!1;k(g)}}})),wp.element.createElement(B,null),wp.element.createElement(O,null))},save:function(e){var t=b.save();return wp.element.createElement("div",t,"save")}})})();
//# sourceMappingURL=index.js.map